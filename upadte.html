<!DOCTYPE html>
<html>

<head>
    <title>Update</title>
    <meta charset="utf-8">
</head>

<body>
    <div>
        <a>源数据</a>
        <textarea style="width: 100%;height: 300px;" id="sourcetxt"></textarea>

        <br />
        <br />
        <a>sql模板</a>
        <textarea style="width: 100%;height: 100px;" id="sql"
            placeholder="update ur_usergoods_info_48 set trangoodsins_id = '%0' where goodsins_id =%1 and haha=%2;"></textarea>

        <br />
        <br />
        <button style="color:cornflowerblue;" id="generateButton">生成</button>
        <br />
        <br />
        <a>目标脚本</a>
        <textarea style="width: 100%;height: 900px;" id="result"></textarea>
    </div>


    <script>
        var generateButton = document.getElementById("generateButton");
        generateButton.addEventListener('click', function () {
            let source = document.getElementById("sourcetxt").value;
            let sql = document.getElementById("sql").value;
            if (sql.indexOf(";") == -1) {
                alert("sql语句没有;号");
                return;
            }
            let result = [];
            let sourcean = source.split("\n");
            for (let i = 0; i < sourcean.length; i++) {
                let line = sourcean[i];
                if (line == "") {
                    continue;
                }
                line = line.split("\t");
                console.log(line);
                let reg = /%(\d)/g;
                let match = sql.match(reg);
                console.log(match);
                let sqltest = sql;
                for (let j = 0; j < match.length; j++) {
                    console.log(match[j]);
                    let index = match[j].replace("%", "");
                    let replace = line[index];
                    sqltest = sqltest.replace(match[j], replace);
                }
                result.push(sqltest);
            }
            document.getElementById("result").value = result.join("\n");
        })
    </script>
</body>

</html>